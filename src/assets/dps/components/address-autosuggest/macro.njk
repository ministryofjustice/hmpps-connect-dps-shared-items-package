{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "moj/components/alert/macro.njk" import mojAlert %}

{% macro addressAutosuggest(options) %}

    <div class="hmpps-js-address-autosuggest">
        <input type="hidden" id="uprn" class="hmpps-js-uprn hmpps-display-none" name="uprn" {% if options.uprn %} value="{{ options.uprn }}" {% endif %} />
        <div
                class="hmpps-address-autosuggest{% if options.classes %} {{ options.classes }}{% endif %}"
                data-aria-you-have-selected="You have selected"
                data-aria-min-chars="Enter 3 or more characters for suggestions."
                data-aria-one-result="There is one suggestion available."
                data-aria-n-results="There are {n} suggestions available."
                data-no-results="No results found. Try entering a different part of the address"
                data-type-more="Enter more of the address to get results"
                data-error-api="The address search is not working right now. Enter the address manually to continue."
                data-styling-base-class="hmpps-address-autosuggest"
                data-find-url="{{ options.findUrl or "/api/addresses/find" }}"
                data-fetch-delay="{{ options.fetchDelay or 500 }}"
        >
            {{ govukInput({
                id: 'address-autosuggest-input',
                name: 'address-autosuggest-input',
                classes: 'hmpps-js-autosuggest-input',
                value: options.inputValue,
                attributes: {
                    'autocomplete': 'off',
                    'aria-describedby': 'address-hint'
                },
                errorMessage: options.errorMessage
            }) }}
            <div class="hmpps-address-autosuggest__results hmpps-js-autosuggest-results">
                <div id="address-results" class="hmpps-address-autosuggest__results-title hmpps-js-autosuggest-results-title">
                    Select an address
                </div>
                <ul
                        class="hmpps-address-autosuggest__listbox hmpps-js-autosuggest-listbox"
                        title="Select an address"
                        role="listbox"
                        id="address-autosuggest-listbox"
                        tabindex="-1"></ul>
            </div>
            <div
                    class="hmpps-address-autosuggest__instructions hmpps-js-autosuggest-instructions govuk-visually-hidden"
                    id="address-autosuggest-instructions"
                    tabindex="-1">
                Use up and down keys to navigate suggestions once you have typed more than two characters. Use the enter key to select a
                suggestion. Touch device users, explore by touch or with swipe gestures.
            </div>
            <div
                    class="hmpps-address-autosuggest__status hmpps-js-autosuggest-aria-status govuk-visually-hidden "
                    aria-live="assertive"
                    aria-atomic="true"
                    role="status"
                    tabindex="-1"></div>
            {{ mojAlert({
                variant: "warning",
                classes: 'hmpps-address-autosuggest__error hmpps-js-autosuggest-error hmpps-display-none'
            }) }}
        </div>
    </div>
{% endmacro %}
